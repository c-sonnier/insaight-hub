<div class="drawer-side z-40" data-controller="nav-sidebar">
  <label for="sidebar-drawer" aria-label="close sidebar" class="drawer-overlay"></label>
  <aside class="flex flex-col min-h-full w-64 bg-base-100 border-r border-base-300 transition-all duration-200" data-nav-sidebar-target="sidebar">
    <!-- Logo / Brand -->
    <div class="flex items-center h-16 px-4 border-b border-base-300">
      <%= image_tag "logo_h_36.svg", class: "h-9 shrink-0", alt: "insAIght Hub" %>
      <span class="ml-3 text-lg font-bold whitespace-nowrap overflow-hidden" data-nav-sidebar-target="label">insAIght Hub</span>
    </div>

    <!-- Main Navigation -->
    <ul class="menu w-full grow px-2 py-4 gap-1">
      <li>
        <%= link_to root_path, class: "#{current_page?(root_path) ? 'active' : ''} tooltip tooltip-right", data: { tip: "Dashboard" } do %>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="size-5 shrink-0">
            <rect x="3" y="3" width="7" height="9"></rect>
            <rect x="14" y="3" width="7" height="5"></rect>
            <rect x="14" y="12" width="7" height="9"></rect>
            <rect x="3" y="16" width="7" height="5"></rect>
          </svg>
          <span data-nav-sidebar-target="label">Dashboard</span>
        <% end %>
      </li>
      <li>
        <%= link_to insight_items_path, class: "#{current_page?(insight_items_path) ? 'active' : ''} tooltip tooltip-right", data: { tip: "Browse Insights" } do %>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="size-5 shrink-0">
            <path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"></path>
            <path d="M14 2v4a2 2 0 0 0 2 2h4"></path>
            <path d="M10 9H8"></path>
            <path d="M16 13H8"></path>
            <path d="M16 17H8"></path>
          </svg>
          <span data-nav-sidebar-target="label">Browse Insights</span>
        <% end %>
      </li>
      <li>
        <%= link_to my_insights_path, class: "#{current_page?(my_insights_path) ? 'active' : ''} tooltip tooltip-right", data: { tip: "My Insights" } do %>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="size-5 shrink-0">
            <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
            <circle cx="9" cy="7" r="4"></circle>
            <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
          </svg>
          <span data-nav-sidebar-target="label">My Insights</span>
        <% end %>
      </li>
      <li>
        <%= link_to how_to_path, class: "#{current_page?(how_to_path) ? 'active' : ''} tooltip tooltip-right", data: { tip: "How To" } do %>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="size-5 shrink-0">
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
            <path d="M12 17h.01"></path>
          </svg>
          <span data-nav-sidebar-target="label">How To</span>
        <% end %>
      </li>

      <li class="mt-2">
        <%= link_to new_insight_item_path, class: "btn btn-primary btn-sm justify-start tooltip tooltip-right", data: { tip: "New Insight" } do %>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="size-5 shrink-0">
            <path d="M12 5v14"></path>
            <path d="M5 12h14"></path>
          </svg>
          <span data-nav-sidebar-target="label">New Insight</span>
        <% end %>
      </li>

      <% if Current.user&.admin? %>
        <li class="menu-title mt-6" data-nav-sidebar-target="menuTitle">
          <span>Admin</span>
        </li>
        <li>
          <%= link_to admin_users_path, class: "#{current_page?(admin_users_path) ? 'active' : ''} tooltip tooltip-right", data: { tip: "Users" } do %>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="size-5 shrink-0">
              <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
              <circle cx="9" cy="7" r="4"></circle>
              <line x1="19" y1="8" x2="19" y2="14"></line>
              <line x1="22" y1="11" x2="16" y2="11"></line>
            </svg>
            <span data-nav-sidebar-target="label">Users</span>
          <% end %>
        </li>
        <li>
          <%= link_to admin_invites_path, class: "#{current_page?(admin_invites_path) ? 'active' : ''} tooltip tooltip-right", data: { tip: "Invites" } do %>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="size-5 shrink-0">
              <rect x="2" y="4" width="20" height="16" rx="2"></rect>
              <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path>
            </svg>
            <span data-nav-sidebar-target="label">Invites</span>
          <% end %>
        </li>
      <% end %>
    </ul>

    <!-- Bottom Section: Theme & Profile -->
    <div class="border-t border-base-300 p-2 space-y-1">
      <!-- Collapse Toggle -->
      <button type="button" class="btn btn-ghost btn-sm w-full justify-start hidden lg:flex" data-action="nav-sidebar#toggle" title="Toggle sidebar">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="size-5 shrink-0 transition-transform duration-200" data-nav-sidebar-target="toggleIcon">
          <path d="M15 18l-6-6 6-6"></path>
        </svg>
        <span data-nav-sidebar-target="label">Collapse</span>
      </button>

      <!-- Theme Selector -->
      <div class="dropdown dropdown-top w-full" data-controller="theme" data-theme-current-value="<%= Current.user&.theme || 'light' %>">
        <div tabindex="0" role="button" class="btn btn-ghost btn-sm w-full justify-start tooltip tooltip-right" data-tip="Theme">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="size-5 shrink-0">
            <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path>
          </svg>
          <span data-nav-sidebar-target="label">Theme</span>
        </div>
        <ul tabindex="0" class="dropdown-content z-50 menu p-2 shadow-lg bg-base-100 rounded-box w-56 mb-2 max-h-96 overflow-y-auto flex-nowrap">
          <li class="menu-title text-xs">Theme</li>
          <% %w[light dark cupcake bumblebee emerald corporate synthwave retro cyberpunk valentine halloween garden forest aqua lofi pastel fantasy wireframe black luxury dracula cmyk autumn business acid lemonade night coffee winter dim nord sunset caramellatte abyss silk].each do |theme| %>
            <li>
              <button class="gap-3 px-2" data-set-theme="<%= theme %>" data-action="theme#change" data-theme-target="item">
                <div data-theme="<%= theme %>" class="bg-base-100 grid shrink-0 grid-cols-2 gap-0.5 rounded-md p-1 shadow-sm">
                  <div class="bg-base-content size-1 rounded-full"></div>
                  <div class="bg-primary size-1 rounded-full"></div>
                  <div class="bg-secondary size-1 rounded-full"></div>
                  <div class="bg-accent size-1 rounded-full"></div>
                </div>
                <div class="w-32 truncate text-left"><%= theme %></div>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" class="invisible h-3 w-3 shrink-0" data-checkmark>
                  <path d="M20.285 2l-11.285 11.567-5.286-5.011-3.714 3.716 9 8.728 15-15.285z"></path>
                </svg>
              </button>
            </li>
          <% end %>
        </ul>
      </div>

      <!-- Profile -->
      <div class="dropdown dropdown-top w-full">
        <div tabindex="0" role="button" class="btn btn-ghost btn-sm w-full justify-start tooltip tooltip-right" data-tip="<%= Current.user&.name %>">
          <%= user_avatar_or_initials(Current.user, size: "w-6") %>
          <span class="truncate" data-nav-sidebar-target="label"><%= Current.user&.name %></span>
        </div>
        <ul tabindex="0" class="dropdown-content z-50 menu p-2 shadow-lg bg-base-100 rounded-box w-52 mb-2">
          <li><%= link_to "Profile", profile_path %></li>
          <li>
            <%= button_to "Sign out", session_path, method: :delete, class: "text-error" %>
          </li>
        </ul>
      </div>
    </div>
  </aside>
</div>
